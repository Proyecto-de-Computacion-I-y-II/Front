<div class="page-container">
  <header *ngIf="showHeader" class="custom-toolbar">
    <div class="toolbar-left">
      <!-- Logo -->
      <img class="logo" src="logo.png" alt="Food Advisor"  [routerLink]="['/home']">
      
      <!-- Buscador para escritorio -->
      <div class="search-container" 
           [ngClass]="{'search-container-show': !isMobileView && !hideSearch, 
                      'search-container-hidden': !isMobileView && hideSearch,
                      'show-search': isMobileView && showSearchBar}">
        <input class="search-input"
               type="text"
               [(ngModel)]="searchQuery"
               (keyup)="onSearchKeyUp($event)"
               placeholder="Buscar productos...">
        <button class="search-button" (click)="handleSearch()">
          <mat-icon>search</mat-icon>
        </button>
      </div>
      
      <!-- Navegación para escritorio -->
      <nav class="desktop-nav">
        <a [routerLink]="['/inicio']" routerLinkActive="active">Inicio</a>
        <a [routerLink]="['/home']" routerLinkActive="active">Productos</a>
        <a [routerLink]="['/temporada']" routerLinkActive="active">Productos de temporada</a>
      </nav>
    </div>
    
    <div class="toolbar-right">
      <!-- Botón menú hamburguesa para móvil -->
      <button class="menu-button" [ngClass]="{'active': showMobileMenu}" (click)="toggleMobileMenu()">
        <span></span>
        <span></span>
        <span></span>
      </button>
      
      <!-- Botón de búsqueda para móvil -->
      <button *ngIf="isMobileView && !hideSearch" class="icon-button search-icon-button" (click)="toggleSearchBar()">
        <mat-icon>search</mat-icon>
      </button>
      
      <!-- Botón de carrito -->
      <button class="cart-button" (click)="goToCesta()">
        <mat-icon>shopping_cart</mat-icon>
      </button>

      <!-- Botón borrar cesta (solo visible cuando el usuario está autenticado) -->
      <button *ngIf="showProfile" class="delete-cart-button" (click)="confirmDeleteCart()">
        <mat-icon>delete</mat-icon>
        <span class="delete-cart-text">Borrar cesta</span>
      </button>

      <!-- Diálogo de confirmación con overlay -->
      <div *ngIf="showDeleteConfirmation" class="confirmation-overlay" (click)="closeConfirmationOnOutsideClick($event)">
        <div class="delete-confirmation-dialog">
          <div class="delete-dialog-header">
            <div class="delete-dialog-icon">
              <mat-icon>delete</mat-icon>
            </div>
            <h2 class="delete-dialog-title">Confirmar eliminación</h2>
          </div>
          
          <div class="delete-dialog-content">
            <p>¿Estás seguro de que deseas borrar todos los productos de tu cesta?</p>
            <p>Esta acción no se puede deshacer.</p>
          </div>
          
          <div class="delete-dialog-actions">
            <button class="cancel-button" (click)="cancelDeleteCart()">Cancelar</button>
            <button class="confirm-delete-button" (click)="acceptDeleteCart()">
              <mat-icon>delete_forever</mat-icon>
              Eliminar
            </button>
          </div>
        </div>
      </div>

      

      
      <!-- Perfil de usuario o botón de login -->
      <ng-container *ngIf="showProfile; else loginButton">
        <img class="user-avatar" src="avatar.png" alt="User" [routerLink]="['/profile']">
        <span class="user-name">{{ userName }}</span>
      </ng-container>
      
      <ng-template #loginButton>
        <button *ngIf="!hideLoginButton" class="login-button" [routerLink]="['/login']">Iniciar sesión</button>
      </ng-template>
    </div>
  </header>
  
  <!-- Menú móvil desplegable -->
  <div class="mobile-nav" [ngClass]="{'show-mobile-menu': showMobileMenu}">
    <a mat-button [routerLink]="['/inicio']" routerLinkActive="active" (click)="closeMobileMenu()">Inicio</a>
    <a mat-button [routerLink]="['/home']" routerLinkActive="active" (click)="closeMobileMenu()">Productos</a>
    <a mat-button [routerLink]="['/temporada']" routerLinkActive="active" (click)="closeMobileMenu()">Productos de temporada</a>
  </div>

  
  <!-- Overlay para el menú móvil -->
  <div class="mobile-menu-overlay" [ngClass]="{'active': showMobileMenu}" (click)="closeMobileMenu()"></div>
  
  <!-- Contenido principal -->
  <main class="content">
    <router-outlet></router-outlet>
  </main>
  
  <!-- Footer -->
  <footer class="footer">
    <!-- Contenido del footer -->
  </footer>
</div>
